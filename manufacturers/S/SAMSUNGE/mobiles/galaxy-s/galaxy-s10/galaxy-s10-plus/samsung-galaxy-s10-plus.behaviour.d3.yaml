type: d3-device-type-behaviour
credentialSubject:
  id: 35ece99c-7c6d-4e30-b718-12cd110749ae
  ruleName: Samsung Galaxy S10 Plus
  rules:
  - ruleName: ntp
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:123
        destinationDnsname:
          allowed: false
          addr: >-
            .*:123
          children:
          - allowed: true
            addr: com.google.time4:123
          - allowed: true
            addr: org.computer42.hetzner.obelix:123
  - ruleName: internet
    matches:
      ip4:
        destinationIp4:
          allowed: true
          addr: >-
            ^(?!(192\.168\.1\.1|10\.0\.0\.1|10\.|192\.168\.|172\.16-31\.|(224-239)\.|255\.255\.255\.255|169\.254\.|127\.|john-nqm\.|(240-255)\.|0\.|192\.0\.0\.)).*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          children:
          - allowed: false
            addr: 8..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: 8.209.77.113:443
          - allowed: false
            addr: 89..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: 89.21.226.138.*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
        destinationDnsname:
          allowed: true
          addr: >-
            ^(?!(192\.168\.1\.1|10\.0\.0\.1|10\.|192\.168\.|172\.16-31\.|(224-239)\.|255\.255\.255\.255|169\.254\.|127\.|john-nqm\.|(240-255)\.|0\.|192\.0\.0\.)).*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          children:
          - allowed: false
            addr: com.akamaitechnologies..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.akamaitechnologies.static.deploy..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-18-184-76-236..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-18-184-76-236:443
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-18-196-142-136..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-18-196-142-136:8883
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-18-197-160-145..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-18-197-160-145:443
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-18-197-183-192..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-18-197-183-192:8883
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-52-29-140-27..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-52-29-140-27:443
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-52-29-160-219..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-52-29-160-219:443
          - allowed: false
            addr: com.amazonaws.compute.eu-central-1.ec2-52-29-216-174..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.amazonaws.compute.eu-central-1.ec2-52-29-216-174:443
          - allowed: false
            addr: com.facebook.edge-msgr-latest-shv-01-lhr8..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.facebook.edge-msgr-latest-shv-01-lhr8:443
          - allowed: false
            addr: com.facebook.edge-star-shv-01-lhr8..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.facebook.edge-star-shv-01-lhr8.web..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          - allowed: false
            addr: com.facebook.whatsapp-chatd-edge-shv-01-lhr8..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.facebook.whatsapp-chatd-edge-shv-01-lhr8:5222
          - allowed: false
            addr: com.googleusercontent..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: com.googleusercontent.bc..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: false
                addr: com.googleusercontent.bc.35.186.224.25..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
                children:
                - allowed: true
                  addr: com.googleusercontent.bc.35.186.224.25:443
              - allowed: false
                addr: com.googleusercontent.bc.35.186.224.47..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
                children:
                - allowed: true
                  addr: com.googleusercontent.bc.35.186.224.47:443
          - allowed: false
            addr: net.1e100.ams16s22-in-f4..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.1e100.ams16s22-in-f4:443
          - allowed: false
            addr: net.1e100.lhr25s31-in-f10..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.1e100.lhr25s31-in-f10:443
          - allowed: false
            addr: net.1e100.lhr25s33-in-f14..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.1e100.lhr25s33-in-f14:443
          - allowed: false
            addr: net.1e100.lhr48s27-in-f10..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.1e100.lhr48s27-in-f10:443
          - allowed: false
            addr: net.1e100.lhr48s27-in-f14..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.1e100.lhr48s27-in-f14.web..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          - allowed: false
            addr: net.cloudfront..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.cloudfront.r..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: false
                addr: net.cloudfront.r.lhr61.server-13-224-222-82..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
                children:
                - allowed: true
                  addr: net.cloudfront.r.lhr61.server-13-224-222-82:443
              - allowed: false
                addr: net.cloudfront.r.lhr61.server-99-86-114-87..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
                children:
                - allowed: true
                  addr: net.cloudfront.r.lhr61.server-99-86-114-87:443
          - allowed: false
            addr: net.fbcdn.edge-video-shv-01-lhr8..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.fbcdn.edge-video-shv-01-lhr8:443
          - allowed: false
            addr: net.llnw..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: true
              addr: net.llnw.lhr..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: false
                addr: net.llnw.lhr.https-87-248-204-27..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
                children:
                - allowed: true
                  addr: net.llnw.lhr.https-87-248-204-27:80
  - ruleName: localnetwork
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^(10\.|192\.168\.|172\.16-31\.).*
          children:
          - allowed: true
            addr: 10.0.5.1:80
          - allowed: true
            addr: 10.0.5.255:51537
          - allowed: true
            addr: 10.0.5.255:57621
          - allowed: true
            addr: 10.0.7.237:14568
          - allowed: true
            addr: 10.0.7.237:41451
        destinationDnsname:
          allowed: false
          addr: >-
            ^(10\.|192\.168\.|172\.16-31\.).*
  - ruleName: microsoftds
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:445
        destinationDnsname:
          allowed: false
          addr: >-
            .*:445
  - ruleName: netbios
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:(137|138|139)
        destinationDnsname:
          allowed: false
          addr: >-
            .*:(137|138|139)
  - ruleName: multicast
    matches:
      ip4:
        destinationIp4:
          allowed: true
          addr: >-
            ^(224-239)\..*
          children:
          - allowed: false
            addr: 224..*
            children:
            - allowed: true
              addr: 224.0..*
              children:
              - allowed: false
                addr: 224.0.0..*
                children:
                - allowed: true
                  addr: 224.0.0.251:5353
          - allowed: false
            addr: 226.0..*
            children:
            - allowed: true
              addr: 226.0.16.16:30012
          - allowed: false
            addr: 226.120..*
            children:
            - allowed: true
              addr: 226.120.89.84:30012
          - allowed: false
            addr: 226.121..*
            children:
            - allowed: true
              addr: 226.121.84.83:30012
          - allowed: false
            addr: 226.122..*
            children:
            - allowed: true
              addr: 226.122.49.48:30012
          - allowed: false
            addr: 226.35..*
            children:
            - allowed: true
              addr: 226.35.85.69:30012
          - allowed: false
            addr: 226.64..*
            children:
            - allowed: true
              addr: 226.64.17.17:30012
          - allowed: false
            addr: 226.65..*
            children:
            - allowed: true
              addr: 226.65.134.220:30012
          - allowed: false
            addr: 226.66..*
            children:
            - allowed: true
              addr: 226.66.89.65:30012
          - allowed: false
            addr: 226.67..*
            children:
            - allowed: true
              addr: 226.67.113.110:30012
          - allowed: false
            addr: 226.72..*
            children:
            - allowed: true
              addr: 226.72.116.45:30012
          - allowed: false
            addr: 226.73..*
            children:
            - allowed: true
              addr: 226.73.114.117:30012
          - allowed: false
            addr: 226.74..*
            children:
            - allowed: true
              addr: 226.74.105.114:30012
          - allowed: false
            addr: 226.75..*
            children:
            - allowed: true
              addr: 226.75.0.115:30012
          - allowed: false
            addr: 239..*
            children:
            - allowed: true
              addr: 239.255.255.250.*
        destinationDnsname:
          allowed: true
          addr: >-
            ^(224-239)\..*
  - ruleName: smtps
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:465
        destinationDnsname:
          allowed: false
          addr: >-
            .*:465
  - ruleName: telnet
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:23
        destinationDnsname:
          allowed: false
          addr: >-
            .*:23
  - ruleName: imap-tls
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:993
        destinationDnsname:
          allowed: false
          addr: >-
            .*:993
          children:
          - allowed: true
            addr: net.1e100.wa-in-f108:993
          - allowed: true
            addr: net.1e100.wa-in-f109:993
          - allowed: true
            addr: net.1e100.wb-in-f108:993
          - allowed: true
            addr: net.1e100.wb-in-f109:993
          - allowed: true
            addr: net.1e100.wf-in-f109:993
          - allowed: true
            addr: net.1e100.wg-in-f108:993
          - allowed: true
            addr: net.1e100.wn-in-f109:993
          - allowed: true
            addr: net.1e100.wo-in-f108:993
          - allowed: true
            addr: net.1e100.wq-in-f108:993
          - allowed: true
            addr: net.1e100.wr-in-f108:993
          - allowed: true
            addr: net.1e100.wr-in-f109:993
          - allowed: true
            addr: net.1e100.ws-in-f108:993
          - allowed: true
            addr: net.1e100.ws-in-f109:993
  - ruleName: gateway
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^(192\.168\.1\.1|10\.0\.0\.1).*
        destinationDnsname:
          allowed: false
          addr: >-
            ^(192\.168\.1\.1|10\.0\.0\.1).*
  - ruleName: dhcp
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:(67|68|647|847)
          children:
          - allowed: true
            addr: 255.255.255.255:67
        destinationDnsname:
          allowed: false
          addr: >-
            .*:(67|68|647|847)
  - ruleName: dns
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:53
          children:
          - allowed: true
            addr: 10.0.5.1:53
        destinationDnsname:
          allowed: false
          addr: >-
            .*:53
  - ruleName: broadcast
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^255\.255\.255\.255.*
          children:
          - allowed: true
            addr: 255.255.255.255:30011
          - allowed: true
            addr: 255.255.255.255:3703
        destinationDnsname:
          allowed: false
          addr: >-
            ^255\.255\.255\.255.*
  - ruleName: ssh
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:22
        destinationDnsname:
          allowed: false
          addr: >-
            .*:22
