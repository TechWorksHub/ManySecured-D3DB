type: d3-device-type-behaviour
credentialSubject:
  id: 76ceeee8-3410-490f-b945-e06bc4a92f2b
  ruleName: ekviz CP1 4MP
  rules:
  - ruleName: ntp
    matches:
      ip4:
        destinationIp4:
          allowed: true
          addr: >-
            .*:123
          children:
          - allowed: false
            addr: 103..*:123
            children:
            - allowed: true
              addr: 103.219.22.112:123
          - allowed: false
            addr: 132..*:123
            children:
            - allowed: true
              addr: 132.226.210.133:123
          - allowed: false
            addr: 141..*:123
            children:
            - allowed: true
              addr: 141.95.62.57:123
          - allowed: false
            addr: 155..*:123
            children:
            - allowed: true
              addr: 155.248.196.28:123
          - allowed: false
            addr: 178..*:123
            children:
            - allowed: true
              addr: 178.33.101.170:123
          - allowed: false
            addr: 183..*:123
            children:
            - allowed: true
              addr: 183.136.184.225:123
          - allowed: false
            addr: 185..*:123
            children:
            - allowed: true
              addr: 185.83.169.27:123
          - allowed: false
            addr: 66..*:123
            children:
            - allowed: true
              addr: 66.85.78.80:123
          - allowed: false
            addr: 81..*:123
            children:
            - allowed: true
              addr: 81.128.218.110:123
          - allowed: false
            addr: 85..*:123
            children:
            - allowed: true
              addr: 85.199.214..*:123
              children:
              - allowed: false
                addr: 85.199.214.100.*:123
                children:
                - allowed: true
                  addr: 85.199.214.100:123
              - allowed: false
                addr: 85.199.214.101.*:123
                children:
                - allowed: true
                  addr: 85.199.214.101:123
        destinationDnsname:
          allowed: true
          addr: >-
            .*:123
          children:
          - allowed: false
            addr: SE..*:123
            children:
            - allowed: true
              addr: SE.Stupi.Time100:123
          - allowed: false
            addr: com.cloudflare..*:123
            children:
            - allowed: true
              addr: com.cloudflare.time:123
          - allowed: false
            addr: com.jettimailfr..*:123
            children:
            - allowed: true
              addr: com.jettimailfr.i.l1:123
          - allowed: false
            addr: com.linodeusercontent..*:123
            children:
            - allowed: true
              addr: com.linodeusercontent.ip.50-116-6-123:123
          - allowed: false
            addr: com.plus..*:123
            children:
            - allowed: true
              addr: com.plus.31-125-29-254:123
          - allowed: false
            addr: cx..*:123
            children:
            - allowed: true
              addr: cx.flashdance.ntp1:123
          - allowed: false
            addr: ms..*:123
            children:
            - allowed: true
              addr: ms.nat.ntp:123
          - allowed: false
            addr: net.allophone..*:123
            children:
            - allowed: true
              addr: net.allophone.dynamic.ne.lnk04.oa02.167-248-49-102:123
          - allowed: false
            addr: net.as42831..*:123
            children:
            - allowed: true
              addr: net.as42831.5-101-146-245:123
          - allowed: false
            addr: net.as44574..*:123
            children:
            - allowed: true
              addr: net.as44574.uk..*:123
              children:
              - allowed: false
                addr: net.as44574.uk.rdg..*:123
                children:
                - allowed: true
                  addr: net.as44574.uk.rdg.time:123
              - allowed: false
                addr: net.as44574.uk.shf..*:123
                children:
                - allowed: true
                  addr: net.as44574.uk.shf.time:123
          - allowed: false
            addr: net.gigaclear..*:123
            children:
            - allowed: true
              addr: net.gigaclear.customer.83-151-207-133:123
          - allowed: false
            addr: net.hojmark..*:123
            children:
            - allowed: true
              addr: net.hojmark.goamst:123
          - allowed: false
            addr: net.init7..*:123
            children:
            - allowed: true
              addr: net.init7.aquila:123
          - allowed: false
            addr: net.m-online..*:123
            children:
            - allowed: true
              addr: net.m-online.ntp2:123
          - allowed: false
            addr: net.ntt..*:123
            children:
            - allowed: true
              addr: net.ntt.gin.ns.y:123
          - allowed: false
            addr: net.padevsoft..*:123
            children:
            - allowed: true
              addr: net.padevsoft.pubservices-ldn1-sirius:123
          - allowed: false
            addr: net.pinklemon..*:123
            children:
            - allowed: true
              addr: net.pinklemon.electra:123
          - allowed: false
            addr: net.project-creative..*:123
            children:
            - allowed: true
              addr: net.project-creative.root.mc1:123
          - allowed: false
            addr: net.quickdrivingtestcancellations..*:123
            children:
            - allowed: true
              addr: net.quickdrivingtestcancellations.server1:123
          - allowed: false
            addr: net.thorcom.ns0..*:123
            children:
            - allowed: true
              addr: net.thorcom.ns0:123
          - allowed: false
            addr: net.thorcom.ns1..*:123
            children:
            - allowed: true
              addr: net.thorcom.ns1:123
          - allowed: false
            addr: net.wirehive.ntp2..*:123
            children:
            - allowed: true
              addr: net.wirehive.ntp2:123
          - allowed: false
            addr: net.wirehive.ntp3..*:123
            children:
            - allowed: true
              addr: net.wirehive.ntp3:123
          - allowed: false
            addr: uk.co.divergentnetworks..*:123
            children:
            - allowed: true
              addr: uk.co.divergentnetworks.ptr.213.5.132.231:123
          - allowed: false
            addr: uk.co.essenet..*:123
            children:
            - allowed: true
              addr: uk.co.essenet.fuji:123
          - allowed: false
            addr: uk.co.turbodns..*:123
            children:
            - allowed: true
              addr: uk.co.turbodns.ns3:123
          - allowed: false
            addr: uk.net..*:123
            children:
            - allowed: true
              addr: uk.net.luns..*:123
              children:
              - allowed: false
                addr: uk.net.luns.ns0..*:123
                children:
                - allowed: true
                  addr: uk.net.luns.ns0:123
              - allowed: false
                addr: uk.net.luns.ns1..*:123
                children:
                - allowed: true
                  addr: uk.net.luns.ns1:123
          - allowed: false
            addr: uk.org.77..*:123
            children:
            - allowed: true
              addr: uk.org.77.ntp1:123
          - allowed: false
            addr: uk.org.halon..*:123
            children:
            - allowed: true
              addr: uk.org.halon.cheddar:123
  - ruleName: internet
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^(?!(192\.168\.1\.1|10\.0\.0\.1|10\.|192\.168\.|172\.16-31\.|(224-239)\.|255\.255\.255\.255|169\.254\.|127\.|john-nqm\.|(240-255)\.|0\.|192\.0\.0\.)).*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          children:
          - allowed: true
            addr: 109.249.185.110:30517
          - allowed: true
            addr: 109.249.185.110:50997
          - allowed: true
            addr: 109.249.185.12:14081
          - allowed: true
            addr: 109.249.185.38.*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          - allowed: true
            addr: 109.249.185.49:38683
          - allowed: true
            addr: 109.249.185.5:26826
          - allowed: true
            addr: 109.249.185.5:26868
          - allowed: true
            addr: 109.249.185.5:51402
          - allowed: true
            addr: 109.249.185.5:59636
          - allowed: true
            addr: 109.249.185.70:51035
          - allowed: true
            addr: 109.249.185.86:18294
          - allowed: true
            addr: 109.249.185.86:55158
          - allowed: true
            addr: 109.249.185.86:5964
          - allowed: true
            addr: 118.193.65.131:7760
          - allowed: true
            addr: 118.193.65.170:7760
          - allowed: true
            addr: 118.193.65.22:7760
          - allowed: true
            addr: 118.26.104.147:7760
          - allowed: true
            addr: 162.62.52.181:6002
          - allowed: true
            addr: 162.62.57.32:6003
          - allowed: true
            addr: 169.197.113.245:7760
          - allowed: true
            addr: 49.51.136.83:6003
          - allowed: true
            addr: 49.51.150.132:6002
          - allowed: true
            addr: 89.21.226.138.*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
        destinationDnsname:
          allowed: false
          addr: >-
            ^(?!(192\.168\.1\.1|10\.0\.0\.1|10\.|192\.168\.|172\.16-31\.|(224-239)\.|255\.255\.255\.255|169\.254\.|127\.|john-nqm\.|(240-255)\.|0\.|192\.0\.0\.)).*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
          children:
          - allowed: true
            addr: com.amazonaws.compute.eu-west-1..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
            children:
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-34-250-216-38..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-34-250-216-38:6000
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-34-250-216-38:6001
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-34-251-86-177..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-34-251-86-177:8666
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-34-252-146-66..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-34-252-146-66:31006
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-52-17-12-33..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-52-17-12-33:8444
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-52-18-170-241..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-52-18-170-241:8666
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-52-209-39-92..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-52-209-39-92:80
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-52-215-204-214..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-52-215-204-214:31006
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-52-48-203-220..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-52-48-203-220:8666
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-52-49-206-3..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-52-49-206-3:8444
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-54-154-82-167..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-54-154-82-167:31006
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-54-229-79-114..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-54-229-79-114:31006
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-54-76-202-50..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-54-76-202-50:80
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-63-35-139-84..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-63-35-139-84:80
            - allowed: false
              addr: com.amazonaws.compute.eu-west-1.ec2-99-81-240-103..*:(?!(20$|21$|22$|23$|25$|37$|53$|67$|68$|647$|847$|115$|123$|137$|138$|139$|143$|220$|109$|110$|1110$|995$|153$|161$|162$|199$|179$|194$|389$|427$|445$|465$|554$|829$|853$|989$|990$|992$|993$|995$))[0-9]+$
              children:
              - allowed: true
                addr: com.amazonaws.compute.eu-west-1.ec2-99-81-240-103:6000
          - allowed: true
            addr: com.amazonaws.s3-3-w:443
  - ruleName: localnetwork
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^(10\.|192\.168\.|172\.16-31\.).*
          children:
          - allowed: true
            addr: 10.0.5.35:10229
          - allowed: true
            addr: 10.0.5.35:10243
          - allowed: true
            addr: 10.0.5.35:10249
          - allowed: true
            addr: 10.0.5.35:10295
          - allowed: true
            addr: 10.0.5.35:10301
          - allowed: true
            addr: 192.168.1.182:10106
          - allowed: true
            addr: 192.168.1.182:10111
          - allowed: true
            addr: 192.168.1.182:10116
          - allowed: true
            addr: 192.168.1.182:10117
          - allowed: true
            addr: 192.168.1.182:10122
          - allowed: true
            addr: 192.168.1.182:10123
          - allowed: true
            addr: 192.168.1.182:10129
          - allowed: true
            addr: 192.168.1.182:10144
          - allowed: true
            addr: 192.168.1.182:10181
          - allowed: true
            addr: 192.168.1.182:10249
          - allowed: true
            addr: 192.168.1.182:10288
        destinationDnsname:
          allowed: false
          addr: >-
            ^(10\.|192\.168\.|172\.16-31\.).*
  - ruleName: microsoftds
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:445
        destinationDnsname:
          allowed: false
          addr: >-
            .*:445
  - ruleName: netbios
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:(137|138|139)
        destinationDnsname:
          allowed: false
          addr: >-
            .*:(137|138|139)
  - ruleName: multicast
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^(224-239)\..*
          children:
          - allowed: true
            addr: 224.0.0.251:5353
          - allowed: true
            addr: 239.255.255.250:1900
          - allowed: true
            addr: 239.255.255.250:37020
          - allowed: true
            addr: 239.255.255.251:50160
        destinationDnsname:
          allowed: false
          addr: >-
            ^(224-239)\..*
  - ruleName: smtps
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:465
        destinationDnsname:
          allowed: false
          addr: >-
            .*:465
  - ruleName: telnet
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:23
        destinationDnsname:
          allowed: false
          addr: >-
            .*:23
  - ruleName: imap-tls
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:993
        destinationDnsname:
          allowed: false
          addr: >-
            .*:993
  - ruleName: gateway
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^(192\.168\.1\.1|10\.0\.0\.1).*
        destinationDnsname:
          allowed: false
          addr: >-
            ^(192\.168\.1\.1|10\.0\.0\.1).*
  - ruleName: dhcp
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:(67|68|647|847)
          children:
          - allowed: true
            addr: 10.0.7.1:67
          - allowed: true
            addr: 255.255.255.255:67
        destinationDnsname:
          allowed: false
          addr: >-
            .*:(67|68|647|847)
  - ruleName: dns
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:53
          children:
          - allowed: true
            addr: 10.0.7.1:53
        destinationDnsname:
          allowed: false
          addr: >-
            .*:53
  - ruleName: broadcast
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            ^255\.255\.255\.255.*
        destinationDnsname:
          allowed: false
          addr: >-
            ^255\.255\.255\.255.*
  - ruleName: ssh
    matches:
      ip4:
        destinationIp4:
          allowed: false
          addr: >-
            .*:22
        destinationDnsname:
          allowed: false
          addr: >-
            .*:22
